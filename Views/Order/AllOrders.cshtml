@model List<CS308Main.Models.Order>

@{
    ViewData["Title"] = "All Orders - Management";
}

<div class="container mt-5">
    <div class="card shadow">
        <div class="card-header bg-dark text-white">
            <h3 class="mb-0">
                <i class="bi bi-truck"></i> All Orders Management
            </h3>
        </div>
        <div class="card-body">
            @if (TempData["Success"] != null)
            {
                <div class="alert alert-success alert-dismissible fade show" role="alert">
                    @TempData["Success"]
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            }

            @if (Model == null || !Model.Any())
            {
                <div class="alert alert-info">
                    <i class="bi bi-info-circle"></i> No orders found.
                </div>
            }
            else
            {
                <!-- Filter Tabs -->
                <ul class="nav nav-tabs mb-3" id="orderTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="all-tab" data-bs-toggle="tab" data-bs-target="#all" type="button">
                            All Orders (@Model.Count)
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="processing-tab" data-bs-toggle="tab" data-bs-target="#processing" type="button">
                            Processing (@Model.Count(o => o.Status == "Processing"))
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="transit-tab" data-bs-toggle="tab" data-bs-target="#transit" type="button">
                            In-Transit (@Model.Count(o => o.Status == "In-Transit"))
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="delivered-tab" data-bs-toggle="tab" data-bs-target="#delivered" type="button">
                            Delivered (@Model.Count(o => o.Status == "Delivered"))
                        </button>
                    </li>
                </ul>

                <div class="tab-content" id="orderTabsContent">
                    <!-- All Orders -->
                    <div class="tab-pane fade show active" id="all" role="tabpanel">
                        @await Html.PartialAsync("_OrdersTable", Model)
                    </div>
                    
                    <!-- Processing Orders -->
                    <div class="tab-pane fade" id="processing" role="tabpanel">
                        @await Html.PartialAsync("_OrdersTable", Model.Where(o => o.Status == "Processing").ToList())
                    </div>
                    
                    <!-- In-Transit Orders -->
                    <div class="tab-pane fade" id="transit" role="tabpanel">
                        @await Html.PartialAsync("_OrdersTable", Model.Where(o => o.Status == "In-Transit").ToList())
                    </div>
                    
                    <!-- Delivered Orders -->
                    <div class="tab-pane fade" id="delivered" role="tabpanel">
                        @await Html.PartialAsync("_OrdersTable", Model.Where(o => o.Status == "Delivered").ToList())
                    </div>
                </div>
            }
        </div>
    </div>
</div>